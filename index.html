<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lankomumo Statistika - Rokas Šipkauskas</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>
<body>

    <header>
        <h1>Lankomumo Sekimas</h1>
        <div id="auth-section">
            <button id="login-btn" onclick="showLoginModal()">Prisijungti (Admin)</button>
            <button id="logout-btn" class="hidden" onclick="logout()">Atsijungti</button>
        </div>
    </header>

    <div class="container">
        <section class="stats-grid">
            <div class="card">
                <h3>Treniruočių lankomumas</h3>
                <p id="train-stat">0%</p>
                <small id="train-detail">0/0</small>
            </div>
            <div class="card">
                <h3>Rungtynių lankomumas</h3>
                <p id="match-stat">0%</p>
                <small id="match-detail">0/0</small>
            </div>
        </section>

        <section class="charts-section">
            <div class="chart-container">
                <canvas id="attendanceChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="weekdayChart"></canvas>
            </div>
        </section>

        <section id="admin-panel" class="hidden">
            <h2>Pridėti įrašą</h2>
            <form id="add-form">
                <input type="date" id="date-input" required>
                <select id="type-input">
                    <option value="treniruote">Treniruotė</option>
                    <option value="rungtynes">Rungtynės</option>
                </select>
                <select id="status-input">
                    <option value="true">Buvo</option>
                    <option value="false">Nebuvo</option>
                </select>
                <button type="submit">Išsaugoti</button>
            </form>
            <p class="warning">Dėmesio: GitHub Pages yra statinis. Nauji duomenys saugomi naršyklėje. Norėdami atnaujinti visiems, atsisiųskite JSON ir įkelkite į GitHub.</p>
            <button onclick="downloadJSON()">Atsisiųsti atnaujintą data.json</button>
        </section>

        <section class="data-view">
            <div class="header-row">
                <h2>Istorija</h2>
                <button onclick="generatePDF()" class="pdf-btn">Atsisiųsti PDF Ataskaitą</button>
            </div>
            <table id="attendance-table">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Savaitės diena</th>
                        <th>Tipas</th>
                        <th>Statusas</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </section>
    </div>

    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeLoginModal()">&times;</span>
            <h2>Administratoriaus prisijungimas</h2>
            <input type="text" id="username" placeholder="Vartotojas">
            <input type="password" id="password" placeholder="Slaptažodis">
            <button onclick="attemptLogin()">Prisijungti</button>
            <p id="login-error" class="error"></p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
